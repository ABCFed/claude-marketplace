---
name: jenkins-deploy
description: ABC Jenkins é¡¹ç›®å‘å¸ƒæŠ€èƒ½ã€‚æ”¯æŒæ™ºèƒ½å‚æ•°æ¨æ–­å’Œäº¤äº’å¼è§¦å‘ Jenkins æ„å»ºï¼Œè‡ªåŠ¨è·å– Git åˆ†æ”¯å’Œæ ‡ç­¾ä¿¡æ¯ã€‚å½“ç”¨æˆ·è¯·æ±‚"å‘å¸ƒ Jenkins"ã€"è§¦å‘æ„å»º"ã€"éƒ¨ç½²é¡¹ç›®"ã€"Jenkins å‘å¸ƒ"æˆ–ç±»ä¼¼æ“ä½œæ—¶è§¦å‘æ­¤æŠ€èƒ½ã€‚éœ€è¦ç¯å¢ƒå˜é‡ JENKINS_USER å’Œ JENKINS_TOKENã€‚
---

# ABC Jenkins å‘å¸ƒæŠ€èƒ½

äº¤äº’å¼è§¦å‘ Jenkins æ„å»ºï¼Œæ”¯æŒæ™ºèƒ½å‚æ•°æ¨æ–­ï¼ˆè‡ªåŠ¨è§£æåˆ†æ”¯åã€ç¯å¢ƒæ¨æ–­ï¼‰å’Œå®æ—¶çŠ¶æ€ç›‘æ§ã€‚

## å‰ç½®æ¡ä»¶

1. `JENKINS_USER` ç¯å¢ƒå˜é‡å·²è®¾ç½®ï¼ˆJenkins ç”¨æˆ·åï¼‰
2. `JENKINS_TOKEN` ç¯å¢ƒå˜é‡å·²è®¾ç½®ï¼ˆJenkins API Tokenï¼‰
3. å½“å‰åœ¨ Git ä»“åº“ä¸­ï¼ˆç”¨äºè‡ªåŠ¨è·å–åˆ†æ”¯å’Œæ ‡ç­¾ï¼‰

## å®‰è£…

```bash
npx add-skill https://github.com/ABCFed/claude-marketplace/tree/main/skills/jenkins-deploy
```

## å‡†å¤‡

```bash
# ç¼–è¾‘ ~/.zshrc æˆ– ~/.bashrc
export JENKINS_USER="your_jenkins_username"
export JENKINS_TOKEN="your_jenkins_api_token"
source ~/.zshrc
```

## Claude Code ä¸­çš„ä½¿ç”¨æµç¨‹

### æ–¹å¼ä¸€ï¼šä¸¤é˜¶æ®µéƒ¨ç½²ï¼ˆæ¨èï¼Œè¿›åº¦å¯è§ï¼‰

**æ­¥éª¤ 1ï¼šè§¦å‘æ„å»ºï¼ˆè¿”å› JSONï¼‰**

```bash
python scripts/jenkins_deploy.py \
  <project_name> \
  --trigger-only-no-monitor \
  --yes \
  --params "<json>"
```

**è¿”å› JSONï¼š**
```json
{
  "queue_id": 161484,
  "full_name": "abc-his/test/PcFeatureTest",
  "project_name": "PcFeatureTest",
  "build_url": "http://ci.abczs.cn/job/abc-his/job/test/job/PcFeatureTest/"
}
```

**æ­¥éª¤ 2ï¼šå¯åŠ¨åå°ç›‘æ§ï¼ˆä½¿ç”¨ Claude Code run_in_background=trueï¼‰**

```bash
# åœ¨ Claude Code ä¸­ä½¿ç”¨ Bash å·¥å…·ï¼Œè®¾ç½® run_in_background=true
python scripts/jenkins_deploy.py \
  --monitor-only \
  --full-name abc-his/test/PcFeatureTest \
  --queue-id 161484 \
  --display-name PcFeatureTest
```

**é‡è¦è¯´æ˜ï¼š**
- ç›‘æ§ä»»åŠ¡ä½œä¸º**åå°ä»»åŠ¡**è¿è¡Œï¼Œ**ä¸é˜»å¡ä¸»å¯¹è¯**
- è¿›åº¦æ˜¾ç¤ºåœ¨ Claude Code çš„åå°ä»»åŠ¡è¾“å‡ºä¸­
- ç”¨æˆ·å¯ä»¥ç»§ç»­è¿›è¡Œå…¶ä»–æ“ä½œ
- æ„å»ºå®Œæˆåä¼šæ”¶åˆ°ç³»ç»Ÿé€šçŸ¥

**ç›‘æ§è¾“å‡ºç¤ºä¾‹ï¼š**
```
ğŸ“Š å¼€å§‹ç›‘æ§æ„å»º: PcFeatureTest
   Queue ID: 161484
   é¡¹ç›®: abc-his/test/PcFeatureTest

ä»»åŠ¡å¼€å§‹æ‰§è¡Œ (Build #11122)
ğŸ“¦ æ„å»ºå·: #11122
â³ ç›‘æ§æ„å»ºè¿›åº¦...
   éœ€è¦å–æ¶ˆæ—¶ï¼Œè¯·å‘Šè¯‰æˆ‘: "å–æ¶ˆæ„å»º #11122"

â³ [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] 42% (125s)
...
âœ… PcFeatureTest æ„å»ºæˆåŠŸ!
```

## å‚æ•°è¯´æ˜

### --trigger-only-no-monitor æ¨¡å¼ï¼ˆè§¦å‘æ„å»ºï¼‰

| å‚æ•° | å¿…å¡« | è¯´æ˜ |
|------|------|------|
| `project_name` | âœ“ | Jenkins é¡¹ç›®åç§°ï¼ˆå¦‚ PcFeatureTestï¼‰ |
| `--trigger-only-no-monitor` | âœ“ | ä»…è§¦å‘æ„å»ºï¼Œä¸å¯åŠ¨ç›‘æ§ï¼Œè¿”å› JSON |
| `--yes` | âœ“ | è·³è¿‡äº¤äº’å¼ç¡®è®¤ |
| `--params` | âœ“ | JSON æ ¼å¼çš„å®Œæ•´æ„å»ºå‚æ•° |

### --monitor-only æ¨¡å¼

| å‚æ•° | å¿…å¡« | è¯´æ˜ |
|------|------|------|
| `--monitor-only` | âœ“ | åå°ç›‘æ§æ¨¡å¼ |
| `--full-name` | âœ“ | é¡¹ç›®å®Œæ•´è·¯å¾„ï¼ˆå¦‚ abc-his/test/PcFeatureTestï¼‰ |
| `--queue-id` | âœ“ | é˜Ÿåˆ— ID |
| `--display-name` | âœ“ | é¡¹ç›®æ˜¾ç¤ºåç§°ï¼ˆç”¨äºé€šçŸ¥ï¼‰ |

## å®Œæ•´ç¤ºä¾‹

### æµ‹è¯•ç¯å¢ƒå‘å¸ƒ

```bash
# æ­¥éª¤ 1: è§¦å‘æ„å»º
python scripts/jenkins_deploy.py \
  PcFeatureTest \
  --trigger-only-no-monitor \
  --yes \
  --params '{"repoTag":"pc-t2025.53.19","tapdId":"1167459320001118371","featureNo":"70"}'

# è¿”å› JSON:
# {"queue_id": 161484, "full_name": "abc-his/test/PcFeatureTest", ...}

# æ­¥éª¤ 2: å¯åŠ¨åå°ç›‘æ§ï¼ˆåœ¨ Claude Code ä¸­ä½¿ç”¨ run_in_background=trueï¼‰
python scripts/jenkins_deploy.py \
  --monitor-only \
  --full-name abc-his/test/PcFeatureTest \
  --queue-id 161484 \
  --display-name PcFeatureTest
```

### å¼€å‘ç¯å¢ƒå‘å¸ƒ

```bash
python scripts/jenkins_deploy.py \
  staticPcOwn \
  --trigger-only-no-monitor \
  --yes \
  --params '{"repoBranch":"hotfix/xxx-1167459320001118371"}'
```

## å…¶ä»–å‘½ä»¤

```bash
# åˆ—å‡ºæ‰€æœ‰é¡¹ç›®
python scripts/jenkins_deploy.py --list --all

# åˆ—å‡ºå½“å‰ä»“åº“ç›¸å…³çš„é¡¹ç›®ï¼ˆè‡ªåŠ¨è¿‡æ»¤ï¼‰
python scripts/jenkins_deploy.py --list

# åœæ­¢æŒ‡å®šæ„å»ºå·
python scripts/jenkins_deploy.py --stop <build_number>
```

## æµ‹è¯•ä¸éªŒè¯

æ¯æ¬¡ä¿®æ”¹æŠ€èƒ½åï¼Œå»ºè®®æŒ‰ä»¥ä¸‹æµç¨‹éªŒè¯ï¼š

### å¿«é€Ÿæµ‹è¯•å‘½ä»¤

```bash
# è‡ªåŠ¨åŒ–è¿è¡Œæ‰€æœ‰æµ‹è¯•ç”¨ä¾‹
python scripts/run_tests.py
```

### æ‰‹åŠ¨æµ‹è¯•

**1. å‚æ•°éªŒè¯ï¼ˆå¿…åšï¼‰**
```bash
python scripts/jenkins_deploy.py \
  PcFeatureTest \
  --validate \
  --params '{"repoTag":"pc-t2025.53.19","featureNo":"70"}'
```

**2. æ¨¡æ‹Ÿè¿è¡Œï¼ˆå¿…åšï¼‰**
```bash
python scripts/jenkins_deploy.py \
  PcFeatureTest \
  --dry-run \
  --params '{"repoTag":"pc-t2025.53.19","featureNo":"70"}'
```

**è¯¦ç»†æµ‹è¯•ç”¨ä¾‹**ï¼šå‚è§ [test-cases.md](references/test-cases.md)

## å·¥ä½œæµç¨‹ï¼ˆClaude Code æ¨èæ¨¡å¼ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Claude ä½¿ç”¨ AskUserQuestion æ”¶é›†å‚æ•°                     â”‚
â”‚    - é¡¹ç›®åç§°                                               â”‚
â”‚    - Git åˆ†æ”¯ / æ ‡ç­¾                                         â”‚
â”‚    - TAPD IDï¼ˆä»åˆ†æ”¯åè‡ªåŠ¨è§£æï¼‰                             â”‚
â”‚    - featureNoï¼ˆå¦‚æœé¡¹ç›®æœ‰æ­¤å‚æ•°ï¼Œ**å¿…å¡«**ï¼‰                 â”‚
â”‚    - å…¶ä»–æ„å»ºå‚æ•°                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. è°ƒç”¨è„šæœ¬ --trigger-only æ¨¡å¼                            â”‚
â”‚    - ä¼ é€’å®Œæ•´çš„ JSON å‚æ•°                                    â”‚
â”‚    - ç›´æ¥è§¦å‘ Jenkins API                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. è¿”å›æ„å»ºä¿¡æ¯                                            â”‚
â”‚    - Queue ID                                               â”‚
â”‚    - æ„å»ºé¡µé¢ URL                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ™ºèƒ½å‚æ•°æ¨æ–­

| å‚æ•° | æ¨æ–­è§„åˆ™ | ç¤ºä¾‹ |
|------|---------|------|
| `repoBranch` | å½“å‰ Git åˆ†æ”¯ | `hotfix/ç›˜ç‚¹é¡µé¢å¢åŠ å¤‡æ³¨åŠæœç´¢-1167459320001118371` |
| `repoTag` | æœ€æ–° Git æ ‡ç­¾ | `pc-f2026.05.48` |
| `tapdId` / `tapdid` | ä»åˆ†æ”¯åè‡ªåŠ¨è§£æï¼ˆæ ‡å‡†åŒ–æµç¨‹ï¼šåˆ†æ”¯åæœ«å°¾çš„æ•°å­—ï¼‰ | `1167459320001118371` |
| `execType` | æœ‰ tag=deployï¼Œæ—  tag=build | æœ‰ tag â†’ `deploy` |
| `featureNo` | **å¿…å¡«ï¼ˆå½“é¡¹ç›®æœ‰æ­¤å‚æ•°æ—¶ï¼‰**ï¼Œéœ€ç”¨æˆ·æ˜ç¡®æŒ‡å®š | `1122044681001112866` |
| `envNo` | éƒ¨åˆ†é¡¹ç›®éœ€è¦ï¼Œéœ€ç”¨æˆ·æ˜ç¡®æŒ‡å®š | `001` |

### TAPD ID è‡ªåŠ¨è§£æ

æ ‡å‡†åŒ–æµç¨‹ä¸‹ï¼Œåˆ†æ”¯åæ ¼å¼ä¸º `feature/xxx-{TAPD_ID}` æˆ– `hotfix/xxx-{TAPD_ID}`ï¼š

```
åˆ†æ”¯åï¼šhotfix/ç›˜ç‚¹é¡µé¢å¢åŠ å¤‡æ³¨åŠæœç´¢-1167459320001118371
                                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          è‡ªåŠ¨æå– TAPD ID
```

æ— éœ€æ‰‹åŠ¨é…ç½®ï¼Œå‘å¸ƒæ—¶ä¼šè‡ªåŠ¨å¡«å……åˆ° `tapdId` æˆ– `tapdid` å‚æ•°ã€‚

**âš ï¸ é‡è¦**ï¼š
- `featureNo`ï¼ˆåŠŸèƒ½ç¼–å·ï¼‰ï¼š**å½“é¡¹ç›®æœ‰æ­¤å‚æ•°æ—¶å¿…å¡«**ï¼Œéœ€ç”±ç”¨æˆ·æä¾›
- `envNo`ï¼ˆç¯å¢ƒç¼–å·ï¼‰ï¼šéƒ¨åˆ†é¡¹ç›®éœ€è¦ï¼Œéœ€ç”±ç”¨æˆ·æä¾›

## æ”¯æŒçš„å‚æ•°ç±»å‹

| å‚æ•°ç±»å‹ | è¯´æ˜ | äº¤äº’æ–¹å¼ |
|---------|------|---------|
| `StringParameterDefinition` | æ–‡æœ¬è¾“å…¥ | ç›´æ¥è¾“å…¥æˆ–å›è½¦ä½¿ç”¨é»˜è®¤å€¼ |
| `ChoiceParameterDefinition` | ä¸‹æ‹‰é€‰æ‹© | æ˜¾ç¤ºé€‰é¡¹åˆ—è¡¨ï¼Œè¾“å…¥ç¼–å·é€‰æ‹© |
| `PT_CHECKBOX` | å¤é€‰æ¡†å¤šé€‰ | æ˜¾ç¤ºé€‰é¡¹åˆ—è¡¨ï¼Œè¾“å…¥é€—å·åˆ†éš”çš„ç¼–å· |
| `BooleanParameterDefinition` | å¸ƒå°”å€¼ | y/n é€‰æ‹© |
| `WReadonlyStringParameterDefinition` | åªè¯»å‚æ•° | è‡ªåŠ¨ä½¿ç”¨ï¼Œä¸å¯ä¿®æ”¹ |

## å¸¸è§é¡¹ç›®ç±»å‹

**è¯¦ç»†é¡¹ç›®å‚æ•°å‚è€ƒ**ï¼šå‚è§ [projects.md](references/projects.md)

### 1. PcFeatureTest (æµ‹è¯•ç¯å¢ƒå‘å¸ƒ)

**ç”¨é€”**ï¼šä½¿ç”¨æ ‡ç­¾å‘å¸ƒåˆ°æµ‹è¯•ç¯å¢ƒ

**å…³é”®å‚æ•°**ï¼š
- `repoTag`ï¼šå‘å¸ƒæ ‡ç­¾ï¼ˆå¦‚ `pc-t2025.53.19`ï¼‰
- `tapdId`ï¼šTAPD éœ€æ±‚ IDï¼ˆè‡ªåŠ¨ä»åˆ†æ”¯åè§£æï¼‰
- `featureNo`ï¼š**åŠŸèƒ½ç¼–å·ï¼ˆå¿…å¡«ï¼‰**ï¼Œéœ€ç”¨æˆ·æä¾›
- `buildEnv`ï¼šå›ºå®šä¸º `test`

**ç¤ºä¾‹**ï¼š
```bash
python scripts/jenkins_deploy.py \
  PcFeatureTest \
  --trigger-only \
  --params '{"repoTag":"pc-f2026.05.48","tapdId":"1167459320001118371","featureNo":"1122044681001112866"}'
```

### 2. staticPcOwn (å¼€å‘ç¯å¢ƒå‘å¸ƒ)

**ç”¨é€”**ï¼šä½¿ç”¨åˆ†æ”¯å‘å¸ƒåˆ°å¼€å‘ç¯å¢ƒ

**å…³é”®å‚æ•°**ï¼š
- `repoBranch`ï¼šå‘å¸ƒåˆ†æ”¯ï¼ˆå¦‚ `hotfix/xxx-1167459320001118371`ï¼‰
- `dockerTag`ï¼šDocker é•œåƒæ ‡ç­¾ï¼ˆé»˜è®¤ `latest`ï¼‰
- `buildEnv`ï¼šå›ºå®šä¸º `dev`

**ç¤ºä¾‹**ï¼š
```bash
python scripts/jenkins_deploy.py staticPcOwn
```

### 3. static-mf-deepseek (å¾®æœåŠ¡å‘å¸ƒ)

**ç”¨é€”**ï¼šå¾®æœåŠ¡é¡¹ç›®å‘å¸ƒï¼Œæ”¯æŒå¤šåŒºåŸŸéƒ¨ç½²

**å…³é”®å‚æ•°**ï¼š
- `projectRootDir`ï¼šé¡¹ç›®å­ç›®å½•ï¼ˆå¦‚ `packages/mf-deepseek`ï¼‰
- `deployZone`ï¼šéƒ¨ç½²åŒºåŸŸï¼ˆå¤é€‰æ¡†ï¼š`primary` / `standby`ï¼‰
- `repoBranch`ï¼šå‘å¸ƒåˆ†æ”¯

**ç¤ºä¾‹**ï¼š
```bash
python scripts/jenkins_deploy.py static-mf-deepseek
```

## ç¼“å­˜æœºåˆ¶

**ç¼“å­˜ä½ç½®ï¼š** `scripts/cache/jobs.json`

**ç¼“å­˜ç­–ç•¥ï¼š**
- é¦–æ¬¡è¿è¡Œï¼šä» Jenkins API è·å– 542 ä¸ªé¡¹ç›®å¹¶ç¼“å­˜
- åç»­è¿è¡Œï¼šç›´æ¥ä½¿ç”¨ç¼“å­˜ï¼ˆé€Ÿåº¦å¿«ï¼‰
- å¼ºåˆ¶åˆ·æ–°ï¼šä½¿ç”¨ `--refresh` å‚æ•°

**æ‰‹åŠ¨æ¸…é™¤ç¼“å­˜ï¼š**
```bash
rm scripts/cache/jobs.json
```

## æ”¯æŒçš„ Jenkins ç¯å¢ƒ

| ç¯å¢ƒ | Dev | Test |
|------|-----|------|
| abc-his | âœ“ | âœ“ |
| abc-bis | âœ“ | âœ“ |
| abc-cooperation | âœ“ | âœ“ |
| abc-global | âœ“ | âœ“ |
| abc-oa | âœ“ | âœ“ |
| mira | âœ“ | âœ“ |

## é”™è¯¯å¤„ç†

| åœºæ™¯ | å¤„ç†æ–¹å¼ |
|------|---------|
| æœªé…ç½®è®¤è¯ | æç¤ºè®¾ç½® `JENKINS_USER` å’Œ `JENKINS_TOKEN` |
| é¡¹ç›®ä¸å­˜åœ¨ | åˆ—å‡ºå¯ç”¨é¡¹ç›® |
| ç¼ºå°‘ featureNo | **å¦‚æœé¡¹ç›®æœ‰æ­¤å‚æ•°ï¼Œå¿…é¡»æç¤ºç”¨æˆ·æä¾›** |
| æ„å»ºå¤±è´¥ | æ˜¾ç¤ºæ„å»º URL å’Œæ—¥å¿—é“¾æ¥ |
| å‚æ•°éªŒè¯å¤±è´¥ | æç¤ºæ­£ç¡®æ ¼å¼ |
| ç½‘ç»œè¶…æ—¶ | æç¤ºæ£€æŸ¥ç½‘ç»œè¿æ¥ |

## è§¦å‘å…³é”®è¯

Jenkinsã€å‘å¸ƒã€éƒ¨ç½²ã€æ„å»ºã€Deployã€Buildã€CI/CD
